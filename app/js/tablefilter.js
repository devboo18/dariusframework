"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){t.TableFilter=function(t,e){function n(){O=[],A={},P=r(),a(e)}function r(){var e={};return e.table=t,e.filter={active:!0,input:"input[type=search]",notFound:void 0,timeout:null,caseSensitive:!1,debug:!1,sortAfter:!0,callback:function(){},trigger:{element:null,event:"keyup"}},e.sort={active:!1,debug:!1,callback:function(){}},e.pagination={active:!1,count_rows:10,count_links:10,debug:!1,callback:function(){},position:"bottom right"},e}function a(t){function e(t,n){for(var r in t)null!==t[r]&&"object"==_typeof(t[r])?n.hasOwnProperty(r)&&e(t[r],n[r]):n.hasOwnProperty(r)&&(t[r]=n[r])}function n(t){return t?"object"==("undefined"==typeof t?"undefined":_typeof(t))&&t.tagName?t:document.querySelector(t):t}i(),e(P,t||{}),A.tableElement=n(P.table),l(A.tableElement)!==!1&&(P.filter.active&&(A.inputElement=n(P.filter.input),A.notFoundElement=o(P.filter.notFound,A.tableElement),A.triggerElement=n(P.filter.trigger.element)||A.inputElement,u(A.inputElement,A.notFoundElement,A.triggerElement)&&(c(A.tableElement,A.triggerElement,P.filter.trigger.event),s(""))),P.sort.active&&h(A.tableElement),P.pagination.active&&N(1))}function i(){if(O.forEach(function(t){t.element.removeEventListener(t.event,t["function"])}),A.paginationElement&&A.paginationElement.remove(),A.tableElement){var t=p(A.tableElement,P).map(function(t){return t.tr});m(t);var e=A.tableElement.querySelectorAll(".caret");[].forEach.call(e,function(t){t.remove()})}O=[],A={}}function o(t,e){function n(t,n){var r=document.createElement("DIV");return r.className="tf-not-found",r.textContent=t,n.parentNode.insertBefore(r,n.previousSibling),e.querySelectorAll("tbody tr").length&&(r.style.display="none"),r}if(void 0===t)return t;var r;try{r=document.querySelector(t)}catch(a){r=null}return r||(r=n(t,e)),r}function l(t){var e=!!(t&&t.querySelector("tbody")&&t.querySelector("th"));return console.assert(e,"Invalid table."),e}function u(t,e,n){return console.assert(null!==t,"Search input not found."),console.assert(null!==n,"Trigger element not found."),console.assert(null!==e,"Not-found element not found."),!(!t||!n)}function c(t,e,n){function r(t){var e=A.inputElement.value;if(n.indexOf("key")<0)return s(e);try{clearTimeout(A.timeoutFunction)}catch(r){}A.timeoutFunction=setTimeout(function(){s(e)},P.filter.timeout)}e.addEventListener(n,r),O.push({event:n,"function":r,element:e})}function s(t){P.filter.debug&&console.time("Filter time"),"string"!=typeof t&&(t=t.toString());var e=[],n=[],r=A.tableElement,a=p(A.tableElement,P),i=A.notFoundElement,o=t.trim().split(" ").map(function(t){return t.trim()});return P.filter.caseSensitive||(o=o.map(function(t){return t.toLowerCase()})),o.map(function(t,e){t.length||o.splice(e,1)}),o.length?a.forEach(function(t,r){function a(e){function n(t){return!(t.filter&&t.filter.indexOf(e)>=0)||(i++,!1)}t.arrayTds.every(n)}var i=0;o.forEach(a);var l=i==o.length;l?n.push(t.tr):e.push(t.tr)}):n=a.map(function(t){return t.tr}),n.length||e.length||!t.length?void setTimeout(function(){var t=P.pagination.active;n.length&&m(n,t),e.length&&f(e,t),n.length?(d(r)&&(r.style.display=""),i&&!d(i)&&(i.style.display="none")):(d(r)||(r.style.display="none"),i&&d(i)&&(i.style.display="")),P.filter.callback.call(n,e),P.filter.debug&&console.timeEnd("Filter time"),P.pagination.active&&(A.rowsPagination=n),P.sort.active&&void 0!==A.lastSortIndex&&P.filter.sortAfter?E(A.lastSortIndex,!0):P.pagination.active&&N(1)},0):(P.filter.debug&&console.timeEnd("Filter time"),!1)}function f(t,e){for(var n=t.length,r=0;r<n;r++)"none"!=t[r].style.display&&(t[r].style.display="none"),e&&t[r].setAttribute("data-filter","filtered")}function m(t,e){for(var n=t.length,r=0;r<n;r++)"none"==t[r].style.display&&(t[r].style.display=""),e&&t[r].setAttribute("data-filter",null)}function d(t){return t.style.display.indexOf("none")>=0}function g(t){return"filtered"==t.getAttribute("data-filter")}function p(t,e,n){function r(t){function r(t){var n=t.cellIndex,r=b(t,o[n].filter,e),a=y(t,o[n].sort,e);i[i.length]={filter:r,sort:a}}if(n&&g(t))return!0;var i=[],l=t.getElementsByTagName("td");[].forEach.call(l,r);var u={tr:t,arrayTds:i};a[a.length]=u}var a=[],i=t.getElementsByTagName("tbody")[0].getElementsByTagName("tr"),o=v(t);return[].forEach.call(i,r),a}function v(t){function e(t){var e=t.colSpan,r=t.getAttribute("data-filter"),a=t.getAttribute("data-sort");r=r&&r.split(" ")||[],a=a&&a.split(" ")||[];for(var i=0;i<e;i++)n.push({filter:r,sort:a})}var n=[],r=t.getElementsByTagName("th");return[].forEach.call(r,e),n}function b(t,e,n){if(e.indexOf("disabled")>=0)return null;var r=t.getAttribute("data-value"),a=r?r:t.textContent;return n.caseSensitive?a:a.toLowerCase()}function y(t,e,n){function r(t){var e=new Date(t).getTime();return isNaN(e)?0:e}function a(t){return t.match(/[0-9\/]+[\s]+[0-9]+[:]/g)?t=t.split(" ")[0].split("/").reverse().join("-")+" "+t.split(" ")[1]:t.match(/[0-9]{2}[\/]{1}[0-9]{2}[\/]{1}[0-9]{4}/g)&&(t=t.split("/").reverse().join("-")),r(t)}var i=t.getAttribute("data-value"),o=(i||t.textContent).trim();return e.indexOf("disabled")>=0?null:(e.indexOf("number")>=0?o=parseFloat(o.replace(/[,]/g,".").replace(/[^0-9\.\-]/g,"")):e.indexOf("date")>=0?o=r(o):e.indexOf("date-br")>=0&&(o=a(o)),o)}function h(t){var e=t.getElementsByTagName("th"),n=document.createElement("SPAN");A.thSortOrder=A.thSortOrder||[],n.className="caret",n.style.transform="rotate(270deg)",[].forEach.call(e,function(t,e){function r(t,e){for(var n=t.srcElement||t.target;n&&"TH"!=n.tagName;)n=n.parentNode;n&&E(n.cellIndex)}"disabled"!=t.getAttribute("data-sort")&&(t.querySelector("span.caret")||t.appendChild(n.cloneNode()),t.style.cursor="pointer",A.thSortOrder[e]="desc",t.addEventListener("click",r),O.push({event:"click","function":r,element:t}))})}function E(t,e){function n(e,n){for(var r=e.length,a=r;a>0;a=parseInt(a/2))for(var i=a;i<r;i++){for(var o=e[i],l=i;l>=a&&("asc"==n&&o.arrayTds[t].sort<e[l-a].arrayTds[t].sort||"desc"==n&&o.arrayTds[t].sort>e[l-a].arrayTds[t].sort);l-=a)e[l]=e[l-a];e[l]=o}return e}P.sort.debug&&console.time("Sort time");var r=A.tableElement,a=p(r,P,!0),i=r.getElementsByTagName("th"),o=i[t],l=A.thSortOrder[t];if(e||(l="asc"==l?"desc":"asc"),A.lastSortIndex=t,!o)return!1;A.thSortOrder[t]=l,S(o,l);for(var u=a.length,c=n(a,l),s=r.getElementsByTagName("tbody")[0],f=0;f<u;f++)s.appendChild(c[f].tr);P.sort.debug&&console.timeEnd("Sort time"),P.sort.callback.call(),P.pagination.active&&N(1)}function S(t,e){var n=t.getElementsByClassName("caret"),r="asc"==e?"0":"180";n&&(n[0].style.transform="rotate("+r+"deg)")}function N(t){function e(t,e){function n(t){t.className=""}var r=e.paginationElement;if(r){var a=r.getElementsByClassName("active"),i=r.querySelector('a[data-pagination="'+t+'"]');i&&(i=i.parentNode,[].forEach.call(a,n),i.className="active")}}P.pagination.debug&&console.time("Pagination"),t=t||1;var n=A.tableElement,r=p(n,P,!0).map(function(t){return t.tr}),a=r.length,i=(t-1)*P.pagination.count_rows,o=P.pagination.count_rows,l=r.splice(i,o),u=r;l.length&&m(l),u.length&&f(u),T(a,t,P,A),e(t,A),P.pagination.debug&&console.timeEnd("Pagination"),P.pagination.callback.call()}function T(t,e,n,r){function a(t,e,n,r){var a=Math.ceil(t/e),i=Math.ceil(n/r)*r,o=i-(r-1);i>a&&(i=a);var l=i+1,u=o-1;return l>a&&(l=!1),0===u&&(u=!1),!(a<=1)&&{nPages:a,lastPage:i,firstPage:o,rightShift:l,leftShift:u}}function i(t,e){var n=c.cloneNode(),r=s.cloneNode();n.appendChild(r),u.appendChild(n),r.innerHTML=t,isNaN(t)||r.setAttribute("data-pagination",t),r.addEventListener("click",o(e))}function o(t){return function(e){e.preventDefault(),N(t)}}var l=document.createElement("DIV"),u=document.createElement("UL"),c=document.createElement("LI"),s=document.createElement("A"),f=n.pagination.position.indexOf("left")>=0?"left":"right";l.className="pull-"+f,u.className="pagination",s.setAttribute("href","#"),l.appendChild(u);var m=a(t,n.pagination.count_rows,e,n.pagination.count_links);if(!m)return r.currentPagination=!1,r.paginationElement&&r.paginationElement.remove(),!1;var d=r.currentPagination;if(!(d&&m.firstPage<=d.pageNumber&&m.lastPage>=d.pageNumber&&d.totalVisible==t)){r.paginationElement&&r.paginationElement.remove(),m.leftShift&&i("&laquo;",m.leftShift);for(var g=m.firstPage;g<=m.lastPage;g++)i(g,g);m.rightShift&&i("&raquo;",m.rightShift),f=n.pagination.position.indexOf("top")>=0?"previous":"next","previous"==f?r.tableElement.parentNode.insertBefore(l,r.tableElement.previousSibling):r.tableElement.parentNode.insertBefore(l,r.tableElement.nextSibling),r.paginationElement=l,r.currentPagination={pageNumber:e,totalVisible:t}}}function x(){return P}var O,A,P;return n(),{setConfigs:a,getConfigs:x,remove:i,filterTable:s,paginateTable:N,sortTable:E}}}(window);
